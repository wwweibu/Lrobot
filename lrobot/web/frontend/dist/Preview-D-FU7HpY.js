import{_ as y,r as i,o as W,u as g,h as T,c as s,a as t,t as b,b as a}from"./index-DPrRqOM1.js";const R={class:"preview-container"},P=["src"],I={key:1,class:"text-preview"},L=["src"],M=["src"],U=["src"],A=["src"],B=["innerHTML"],C={key:7},j={__name:"Preview",setup(E){const v=g(),r=i(null),e=i(""),o=i(""),u=i(""),d=i("");W(async()=>{const l=v.params.path;if(l[0].endsWith(".mp4")||l[0].endsWith(".mov")||l[0].endsWith(".webm")){e.value="video/mp4",o.value=`/hjd/stream_video?path=${encodeURIComponent(l[0])}`;return}const c=await T.post("/preview",{path:l},{responseType:"blob",timeout:1e4});if(r.value=c.data,e.value=c.headers["content-type"],o.value=URL.createObjectURL(r.value),e.value.startsWith("text")){const n=new FileReader;n.onload=()=>{u.value=n.result},n.readAsText(r.value)}if(e.value==="text/markdown"){const n=new FileReader;n.onload=()=>{d.value=marked.parse(n.result)},n.readAsText(r.value)}});const p=s(()=>e.value==="application/pdf"),m=s(()=>e.value.startsWith("text")),h=s(()=>e.value.startsWith("video")),_=s(()=>e.value.startsWith("audio")),f=s(()=>e.value.startsWith("image")),w=s(()=>e.value==="application/msword"||e.value==="application/vnd.openxmlformats-officedocument.wordprocessingml.document"||e.value==="application/vnd.ms-excel"||e.value==="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"),x=s(()=>e.value==="text/markdown"),k=s(()=>e.value==="application/vnd.ms-powerpoint"||e.value==="application/vnd.openxmlformats-officedocument.presentationml.presentation");return(l,c)=>(a(),t("div",R,[p.value||k.value?(a(),t("iframe",{key:0,src:o.value,class:"preview-frame"},null,8,P)):m.value?(a(),t("pre",I,b(u.value),1)):h.value?(a(),t("video",{key:2,src:o.value,controls:"",preload:"metadata",playsinline:"",width:"100%",style:{"max-height":"80vh"}},null,8,L)):_.value?(a(),t("audio",{key:3,src:o.value,controls:""},null,8,M)):f.value?(a(),t("img",{key:4,src:o.value,alt:"Image preview",width:"100%"},null,8,U)):w.value?(a(),t("iframe",{key:5,src:o.value,width:"100%",height:"600px"},null,8,A)):x.value?(a(),t("div",{key:6,innerHTML:d.value},null,8,B)):(a(),t("p",C,"不支持的文件类型"))]))}},H=y(j,[["__scopeId","data-v-f03c8ecf"]]);export{H as default};
